---
title: "Xaringan Template"
subtitle: "An example"
author: "Patricia Menéndez"
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(palmerpenguins)
library(datasets)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(stringr)
library(lubridate)
library("janitor")
library("kableExtra")
library("plotly")
library("countrycode")
library(data.table)
```

```{r read-data, include=FALSE}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```

class: center, middle
# .red[World Happiness Report]
![](https://media.giphy.com/media/3NtY188QaxDdC/giphy.gif)


---
class: center, middle
# Hello!

Dr Patricia Menéndez
```{r out.width = '35%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/patricia.jpeg")
```

Lecturer Department of Econometric and Business Statistics.





---
# Of course Yourselves too!

![](figs/baim-hanif-pYWuOMhtc6k-unsplash.jpg)

.tiny[<span>Photo by <a href="https://unsplash.com/@baim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Baim Hanif</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>]


---
class: center, middle
# Introduction

.content-box-green[ 
Countries are ranked each year based on a **Happiness Index**. This index rates the happiness of countries on a scale from 0 to 10, and it’s pretty fascinating! <br>
Happiness Index an indexation of happiness based on survey results, that was first used in the 2012 World Happiness Report. In the survey, the respondents were asked to rate their happiness on a scale from 0 to 10. The Happiness Index is calculated by averaging the survey results of the respondents.
]

---
class: center, middle
# Happiness Score by Region

```{r include=FALSE}
happiness <- WHR20 %>% 
  select(`Country name`,`Regional indicator`,`Ladder score`,`Logged GDP per capita`,`Social support`,`Healthy life expectancy`,`Freedom to make life choices`,Generosity,`Perceptions of corruption`) %>% 
  mutate(`Happiness Rank` = rank(-`Ladder score`)) %>% 
  rename(`Happiness Score` = `Ladder score`) %>% clean_names()

#happiness rank : the more the ladder score the higher the rank              

```

```{r regiontable, include=FALSE}
reg_avg <- happiness %>%
  select(regional_indicator,happiness_score) %>%
  group_by(regional_indicator) %>%
  summarize(Average = mean(happiness_score)) %>% 
  arrange(-Average)

```

```{r include=FALSE}
happiness$iso3 <- countrycode(happiness$country_name, 'country.name', 'iso3c')

happiness[happiness$country_name=="Kosovo","iso3"] <- "XKX"


```

```{r region, fig.align='center',fig.height=6,fig.width=10, echo=FALSE, warning=FALSE, message=FALSE}
plot_ly(happiness, x=~regional_indicator,
              y=~happiness_score,
              type="box",
              boxpoints="all",
              color=~regional_indicator,
        text = ~paste("<b>Region:</b> ", regional_indicator,
                      "<br><b>Country:</b> ", country_name,
                      "<br><b>Happiness Score:</b>", happiness_score))%>%
  layout(xaxis=list(showticklabels = FALSE),
         yaxis=list(title="Happiness Score"),
         legend=list(font = (size = 5)),
         margin=list(b = 100),
         title="Box Plot of Happiness Score by Region")
```

---
class: center, middle
.content-box-green[ 
We have collected happiness data from World Happiness Report for 2020. It has global happiness that ranks 156 countries by how happy their citizens perceive themselves to be.<br>
We grouped the countries into different regions in the world to observe which region is the happiest.<br>
From the box plot we see that the happiness scores are quite different among these regions. <br>
The group determined that the **“happiest”** countries were located in **Western Europe**, particularly Finland and Denmark.<br>
Meanwhile the **“least happiest”** countries were located in **Sub-Saharan Africa** and **South Asia**. 
]

---
class: center, middle
# Compare Top5, Middle5 and Worst5 Countries

```{r include=FALSE}
top5 <- happiness %>% head(5) %>% mutate(Level = "TOP5")
middle5 <- happiness[76:80, ] %>% mutate(Level = "MIDDLE5")
worst5 <- happiness %>% tail(5) %>% mutate(Level = "WORST5")

comparison <- bind_rows(top5, middle5, worst5)

comparison$Level <- as.factor(comparison$Level)
comparison <- transform(comparison, Level = factor(Level, levels = c("TOP5", "MIDDLE5", "WORST5" )))
```

```{r include=FALSE}

data.table(comparison,
          options = list(
            lengthMenu = c(5, 10, 15)
          ),
          caption = 
            htmltools::tags$caption(
              style = 'caption-side: bottom; text-align: center;', 
              htmltools::em('Data table that only includes top5, middle5 and worst5 countries'))
          )

```

```{r include=FALSE}
comparison.score <- comparison %>% rename("Economy GDP" = "logged_gdp_per_capita" , "Social Support" = "social_support" , "Health" = "healthy_life_expectancy", "Freedom" = "freedom_to_make_life_choices", "Corruption" ="perceptions_of_corruption") %>% 
  gather(key = "columns", value = "score", happiness_score:Corruption)

```


```{r compare, fig.width=10, echo=FALSE, warning=FALSE, message=FALSE}
comparison.score %>% 
  ggplot(aes(x = Level, y = score, colour = Level, fill = Level)) + 
  geom_boxplot(position=position_dodge(width=1)) + facet_wrap(~columns, scales = "free") 


```


---
class: left, top
.content-box-green[
* Analyzing data of Global Happiness Levels in the world,we were able to discover the impact of each different factor in determining “happiness.”
* Factors to determine happiness score of a country are GDP, Freedom to make choices, how less is the corruption, generosity, heath and social support.
* To understand the relations between factors and happiness score we have take data for the top, median and bottom five countries according to ranked scores. 
* We observe that the countries with highest happiness score have a better GDP, less corruption, more freedom to make choices, good health ratio, more generosity and receive social support. 
]

---
class: left, top

# Adding color to the text

- .green[ This is an example in green]
- .red[ This is an example in green]

- .bold[This is an example in bold]

- you can also use markdown bold syntax **bold**



---
class: center, top

# Unit Structure



.pull-left[
* Start with individual projects 
.tiny[<span>Photo by <a href="https://unsplash.com/@firmbee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">William Iven</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>]
]
.pull-left[
```{r out.width = '50%', echo = FALSE}
knitr::include_graphics("figs/william-iven-gcsNOsPEXfs-unsplash.jpg")
```

]

.pull-left[
 * Will continue with group projects
 
 .tiny[<span>Photo by <a href="https://unsplash.com/@homajob?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Scott Graham</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>]

]
.pull-left[
```{r out.width = '50%', echo = FALSE}
knitr::include_graphics("figs/helloquence-5fNmWej4tAA-unsplash.jpg")
```


]

.pull-left[
 * Finally, as a class, we will produce a join project
 
 .tiny[<span>Photo by <a href="https://unsplash.com/@baim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Baim Hanif</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>]
]
.pull-left[
```{r out.width = '50%', echo = FALSE}
knitr::include_graphics("figs/baim-hanif-pYWuOMhtc6k-unsplash.jpg")
```

]







---
class: left, middle
# Different headings
.green[.bold[Example]] 
### Smaller heading
* My section

### Another samller heading
.content-box-duke-green[ 

  - You will get instructions with the tasks that need to be completed during the tutorial.
  - Fan and Naveen will be there to guide and help you through the activities.
  - Tutorials also provide a good opportunity for you to discuss and work with your peers.
]


---

class: left, middle
# Using also LaTex

.content-box-soft[ 
- .green[.bold[Patricia]] $\leftarrow$ hello hello ]

- $\sum_{i = 1}^{\infty} x_i$

**Bolding using markdown**

---
class: centre, middle
# Questions?



---
class:  center, top

# Let's get started with gifs


![](https://media.giphy.com/media/3ohc1fpw7snh6omAaQ/giphy.gif)





---
class: left, top

# Adding code

```{r }
c(1:10)
```


---
class: left, top
# Adding code

```{r }
penguins %>%
  dplyr::select(body_mass_g,
                ends_with("_mm")
                ) %>%
  glimpse()
```




---
class:  left, top
# Adding figure

.pull-left1[
```{r  penguins , eval = FALSE, warning = FALSE, message = FALSE}
ggplot(data = penguins, 
       aes(x = flipper_length_mm,
           y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species),
             size = 2) +
  scale_color_manual(
    values = c("darkorange",
               "darkorchid",
               "cyan4"))
```
]


.pull-right1[
```{r  penguins2 , eval = TRUE, echo = FALSE, warning = FALSE, message = FALSE}
ggplot(data = penguins,
       aes(x = flipper_length_mm,
           y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species),
             size = 2) +
  scale_color_manual(
    values = c("darkorange",
               "darkorchid",
               "cyan4"))
```
]



---
class:  left, top
# Adding figure --> another way

.right-column[
```{r  penguins3 , eval = FALSE, warning = FALSE, message = FALSE}
ggplot(data = penguins, 
       aes(x = flipper_length_mm,
           y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species),
             size = 2) +
  scale_color_manual(
    values = c("darkorange",
               "darkorchid",
               "cyan4"))
```
]


.left-column[
```{r  penguins4 , eval = TRUE, echo = FALSE, warning = FALSE, message = FALSE}
ggplot(data = penguins,
       aes(x = flipper_length_mm,
           y = body_mass_g)) +
  geom_point(aes(color = species,
                 shape = species),
             size = 2) +
  scale_color_manual(
    values = c("darkorange",
               "darkorchid",
               "cyan4"))
```
]


---
# Tables


```{r}
iris2 <- head(iris)
knitr::kable(iris2,
             col.names = gsub("[.]", " ",
                              names(iris)))
```

---

```{r endslide, child="EndSlide/endslide.Rmd"}
```  