---
title: "Xaringan Template"
subtitle: "An example"
author: "Patricia Menéndez"
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(palmerpenguins)
library(datasets)
library(tidyverse)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(stringr)
library(lubridate)
library(plotly)
```

```{r read-data, echo = FALSE, message = FALSE, warning = FALSE}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```


---
class: center, middle
# Logged GDP per capita 

# v.s. 

# Happiness

“The richer you are, the happier you will be?”

```{r out.width = '50%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/GDP.png")
```

.tiny[<span>Photo by <a href="https://unsplash.com/@till_indeman">Vladimir Solomyani</a> on <a href="https://unsplash.com/photos/rKPiuXLq29A">Unsplash</a></span>]

---
class: center, middle
## Ladder Score vs Logged GDP per capita in Different Regions

```{r GDP-ord, echo = FALSE, out.width='80%', fig.height = 4.5}
gdp_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Logged GDP per capita`),2))%>%
  arrange(-Average)

  gdp_mean %>% 
    kable() %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

---
class: center, middle
### Ladder Score vs GDP for the High GDP Regions

```{r GDP-high, echo = FALSE, fig.align="center", out.width='80%', fig.height = 4.5}
WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3) +
  theme(legend.position = "none")

```

---
class: center, middle
### Ladder Score vs Logged GDP for the Low GDP Regions

```{r GDP-low, echo = FALSE, fig.align="center", out.width='80%', fig.height = 2}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)+
  theme(legend.position = "none")
```

---

**In High GDP Regions:**

- Counties in most regions, they are with either high GDP and high Ladder Score or low GDP and low Ladder Scores.

- In Central and Eastern Europe and Middle East and North Africa, some countries got high GDP scores but low Ladder Scores.

- In Latin America and Caribbean, some countries even their GDP are low but have high Ladder Scores.

**In Low GDP Regions:**

- In above low GDP countries, most are low GDP and low Ladder Scores.

---
class: center, middle
# Social Support 

# v.s. 

# Happiness

“If you were in trouble, do you have relatives or friends you can count on to help you whenever you need them, or not?”

```{r out.width = '50%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/SS.png")
```

.tiny[<span>Photo by <a href="https://unsplash.com/@_imd">Zoe</a> on <a href="https://unsplash.com/photos/0X3b5AL9Rb4">Unsplash</a></span>]

---
class: center, middle
## Ladder Score vs Social Support in Different Regions

```{r SS-ord, echo = FALSE, out.width='80%', fig.height = 4.5}
SS_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Social support`),2))%>%
  arrange(-Average)

  SS_mean %>% 
    kable() %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```


---
class: center, middle
### Ladder Score vs Social Support for the High Social Support Regions

```{r SS-high, echo = FALSE, fig.align="center", out.width='80%', fig.height = 4.5}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)+
  theme(legend.position = "none")
```

---
class: center, middle
### Ladder Score vs Social Support for the Low Social Support Regions

```{r SS-low, echo = FALSE, , fig.align="center", out.width='80%', fig.height = 2}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)+
  theme(legend.position = "none")
```

---

- We nearly found no country has low Social Support score but got high Ladder Score. 

- In North America and ANZ, Southeast Asia, South Asia, Middle East and North Africa and Western Europe, Social Support and Ladder Score is more like positive correlation.

- In other Region, it doesn't show clear relationship between Social Support and Ladder Score.

---
class: center, middle
# Healthy Life Expectancy 

# v.s. 

# Happiness

“Long and Healthy Life = Happy Life?”

```{r out.width = '50%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/HLE.png")
```

.tiny[<span>Photo by <a href="https://unsplash.com/@adliwahid">Adli Wahid</a> on <a href="https://unsplash.com/photos/YdVBgegbzQw">Unsplash</a></span>]

---
class: center, middle
## Ladder Score vs Healthy Life Expectancy in Different Regions

```{r HLE-ord, echo = FALSE}
HLE_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Healthy life expectancy`),2))%>%
  arrange(-Average)

  HLE_mean %>% 
    kable() %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

---
class: center, middle
### Ladder Score vs Healthy Life Expectancy for the High Healthy Life Expectancy Regions

```{r HLE-high, echo = FALSE, fig.align="center", out.width='80%', fig.height = 4.5}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)+
  theme(legend.position = "none")
```

---
class: center, middle
### Ladder Score vs Healthy Life Expectancy for the Low Healthy Life Expectancy Regions

```{r HLE-low, echo = FALSE, , fig.align="center", out.width='80%', fig.height = 2}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`,
             color = `Regional indicator`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)+
  theme(legend.position = "none")
```

---

**In High Healthy Life Expectancy Score Regions:**

- In the high Healthy Life Expectancy score countries group, it shows a positive correlation in Southeast Asia, Middle East and North Africa and North America and ANZ. 

- In the Commonwealth of Independent States, Central and Eastern Europe, Western Europe, some countries are almost at the same level of Healthy life Expectancy, their Ladder Scores arrange from a big difference.

**In Low Healthy Life Expectancy Score Regions:**

- They also have a low Ladder Score, while they don't look have a special relationship between Healthy Life Expectancy and Ladder Score. 
