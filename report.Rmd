---
title: "World Happiness Report 2020"
author:
- familyname: Luo
  othernames: Yu
  address: Monash University
  email: yluo0065@student.monash.com
  correspondingauthor: true
  qualifications:  Master
- familyname: Thakker
  othernames: Khushee
  address: Monash University
  email: ktha0021@student.monash.edu
  qualifications: Master
- familyname: Chen
  othernames: Yunqi
  address: Monash University
  email: yche0454@student.monash.edu
  correspondingauthor: true
  qualifications:  Master
organization: the World Bank data base
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE, message = FALSE, warning = FALSE, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message=FALSE, 
                      warning=FALSE,
                      fig.width = 6, 
                      fig.height = 4,
                      fig.align="center")
knitr::opts_chunk$set(fig.pos = "!h", out.extra = "")

# Libraries

library(tidyverse)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(stringr)
library(lubridate)
```


```{r read-data}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```

\section*{Introduction}

\section*{1 }

\subsection*{1.2 }


\clearpage
\section*{2 }

\subsection*{2.1 GDP}

```{r GDP-bbl}
library(plotly)
GDP <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Logged GDP per capita`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(GDP)
```

```{r GDP-bbl-facet}
GDP + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```

```{r GDP-bar}
gdp_mean <- WHR20 %>% group_by(`Regional indicator`) %>% 
  summarise(mean = weighted.mean(`Ladder score`))

gdp_mean %>% 
  ggplot(aes(`Regional indicator`, 
                   mean, 
                   fill = `Regional indicator`))+
  geom_col()
```

\subsection*{2.2 Social support}

```{r SS-bbl}
SS <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Social support`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(SS)
```

```{r SS-bbl-facet}
SS + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```

\subsection*{2.3 Social Healthy life expectancy}

```{r HLE-bbl}
library(plotly)
HLE <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Healthy life expectancy`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(HLE)
```

```{r HLE-bbl-facet}
HLE + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```


\subsection*{2.4 Freedom to make life choices}

```{r FLC-bbl}
FLC <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(FLC)
```

```{r FLC-bbl-facet}
FLC + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```


\subsection*{2.5 Generosity}

```{r GNR-bbl}
GNR <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Healthy life expectancy`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(GNR)
```

```{r GNR-bbl-facet}
GNR + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```


\subsection*{2.6 Perceptions of corruption}

```{r POC-bbl}
POC <- WHR20 %>% 
    ggplot(aes(x = `Ladder score`, 
               y = `Healthy life expectancy`, 
               size = `Ladder score`, 
               color =`Regional indicator`)) +
    geom_point(alpha = 0.5) +
  scale_size(range = c(.3,6), name="Ladder score")
ggplotly(POC)
```

```{r POC-bbl-facet}
POC + facet_wrap(~ `Regional indicator`, ncol = 2,
                 strip.position = "right")
```

\clearpage
\section*{3 }

\subsection*{3.1 }

\clearpage
\section*{References}


