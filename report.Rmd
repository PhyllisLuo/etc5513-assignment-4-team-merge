---
title: "World Happiness Report 2020"
author:
- familyname: Luo
  othernames: Yu
  address: Monash University
  email: yluo0065@student.monash.com
  correspondingauthor: true
  qualifications:  Master
- familyname: Thakker
  othernames: Khushee
  address: Monash University
  email: ktha0021@student.monash.edu
  qualifications: Master
- familyname: Chen
  othernames: Yunqi
  address: Monash University
  email: yche0454@student.monash.edu
  correspondingauthor: true
  qualifications:  Master
organization: the World Bank data base
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE, message = FALSE, warning = FALSE, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message=FALSE, 
                      warning=FALSE,
                      fig.width = 6, 
                      fig.height = 4,
                      fig.align="center")
knitr::opts_chunk$set(fig.pos = "!h", out.extra = "")

# Libraries

library(tidyverse)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(stringr)
library(lubridate)
```


```{r read-data}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```

\section*{Introduction}

\section*{1 }

\subsection*{1.2 }


\clearpage
\section*{2 }

\subsection*{2.1 GDP}

Table \@ref(tab:GDP-ord) shows the average Logged GDP per capita of Regions from high to low. The top 3 Region with highest GDP are North America and ANZ, Western Europe and East Asia, their GDP are all higher than 10. 

The average GDP for all the countries is `r mean(WHR20$`Logged GDP per capita`)`, and we found three regions' average GDP are lower than this level: Sub-Saharan Africa, South Asia, Commonwealth of Independent States. So we divided two groups, the regions that regional average GDP higher than global, and regions with regional GDP lower than global, to see how is the relationship between the Logged GDP per capita and Ladder score.

```{r GDP-ord}
gdp_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Logged GDP per capita`),2))%>%
  arrange(-Average)

  gdp_mean %>% 
    kable(caption = "Average Logged GDP per capita of Regions from High to Low") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r GDP-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Logged GDP per capita`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Logged GDP per capita`)),
             linetype = "dashed")

mean(WHR20$`Ladder score`)

mean(WHR20$`Logged GDP per capita`)

quantile(WHR20$`Logged GDP per capita`)
```

```{r GDP-high, fig.cap = "Ladder Score vs Logged GDP per Capita for the Regions with Regional Average GDP Higher than Global"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

```{r GDP-low, fig.cap = "Ladder Score vs Logged GDP per Capita for the Regions with Regional Average GDP Lower than Global"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

\subsection*{2.2 Social support}

```{r SS-ord}
SS_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Social support`),2))%>%
  arrange(-Average)

  SS_mean %>% 
    kable(caption = "Average Social support of Regions from High to Low") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r SS-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Social support`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Social support`)),
             linetype = "dashed")

mean(WHR20$`Social support`)

quantile(WHR20$`Social support`)
```

```{r SS-high, fig.cap = "Ladder Score vs Social Support for the Regions with Regional Average Social Support Higher than Global"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

```{r SS-low, fig.cap = "Ladder Score vs Social Support for the Regions with Regional Average Social Support Lower than Global"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

\subsection*{2.3 Social Healthy life expectancy}

```{r HLE-ord}
HLE_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Healthy life expectancy`),2))%>%
  arrange(-Average)

  HLE_mean %>% 
    kable(caption = "Healthy life expectancy") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r HLE-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Healthy life expectancy`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Healthy life expectancy`)),
             linetype = "dashed")

mean(WHR20$`Healthy life expectancy`)

quantile(WHR20$`Healthy life expectancy`)
```

```{r HLE-high, fig.cap = "Ladder Score vs Healthy Life Expectancy for the Regions with Regional Average Healthy Life Expectancy Higher than Global"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

```{r HLE-low, fig.cap = "Ladder Score vs Healthy Life Expectancy for the Regions with Regional Average Healthy Life Expectancy Lower than Global"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

\clearpage
\section*{3 }

\subsection*{3.1 }

\clearpage
\section*{Conclusion}

\clearpage
\section*{References}


