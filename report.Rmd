---
title: "Analysis on World Happiness"
author:
- familyname: Luo
  othernames: Yu
  address: Monash University
  email: yluo0065@student.monash.com
  correspondingauthor: true
  qualifications:  Master
- familyname: Thakker
  othernames: Khushee
  address: Monash University
  email: ktha0021@student.monash.edu
  qualifications: Master
- familyname: Chen
  othernames: Yunqi
  address: Monash University
  email: yche0454@student.monash.edu
  correspondingauthor: true
  qualifications:  Master
organization: the World Happiness Report
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE, message = FALSE, warning = FALSE, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message=FALSE, 
                      warning=FALSE,
                      fig.width = 6, 
                      fig.height = 4,
                      fig.align="center")
knitr::opts_chunk$set(fig.pos = "!h", out.extra = "")

# Libraries

library(tidyverse)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library("janitor")
library("kableExtra")
library("plotly")
library("countrycode")
library(data.table)
```


```{r read-data}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```

\section*{Introduction}

\section*{1 }

```{r}
happiness <- WHR20 %>% 
  select(`Country name`,`Regional indicator`,`Ladder score`,`Logged GDP per capita`,`Social support`,`Healthy life expectancy`,`Freedom to make life choices`,Generosity,`Perceptions of corruption`) %>% 
  mutate(`Happiness Rank` = rank(-`Ladder score`)) %>% 
  rename(`Happiness Score` = `Ladder score`) %>% clean_names()

#happiness rank : the more the ladder score the higher the rank              

```

```{r regiontable}
reg_avg <- happiness %>%
  select(regional_indicator,happiness_score) %>%
  group_by(regional_indicator) %>%
  summarize(Average = mean(happiness_score)) %>% 
  arrange(-Average)

```

```{r}
happiness$iso3 <- countrycode(happiness$country_name, 'country.name', 'iso3c')

happiness[happiness$country_name=="Kosovo","iso3"] <- "XKX"


```

```{r region , fig.cap = "Happiness Score by Region", fig.align='center',fig.height=5,fig.width=8}
plot_ly(happiness, x=~regional_indicator,
              y=~happiness_score,
              type="box",
              boxpoints="all",
              color=~regional_indicator,
        text = ~paste("<b>Region:</b> ", regional_indicator,
                      "<br><b>Country:</b> ", country_name,
                      "<br><b>Happiness Score:</b>", happiness_score))%>%
  layout(xaxis=list(showticklabels = FALSE),
         yaxis=list(title="Happiness Score"),
         legend=list(font = (size = 5)),
         margin=list(b = 100),
         title="Box Plot of Happiness Score by Region")
```


*Happiness Score by Region*

We have collected happiness data from World Happiness Report for 2020. It has global happiness that ranks 156 countries by how happy their citizens perceive themselves to be.

We grouped the countries into different regions in the world to observe which region is the happiest.

From the box plot \@ref(fig:region) we see that the happiness scores are quite different among these regions.

The group determined that the **“happiest”** countries were located in **Western Europe**, particularly Finland and Denmark.

Meanwhile the **“least happiest”** countries were located in **Sub-Saharan Africa** and **South Asia**. 


\subsection*{1.2 }


\clearpage
\section*{2 }

\subsection*{2.1 GDP}

Table \@ref(tab:GDP-ord) shows the average Logged GDP per capita of Regions from high to low. The top 3 regions with the highest GDP are North America and ANZ, Western Europe and East Asia, their GDP is all higher than 10. 

The average GDP for all the countries is `r mean(WHR20$`Logged GDP per capita`)`, and we found three regions' average GDP are lower than this level: Sub-Saharan Africa, South Asia, Commonwealth of Independent States. We divided into two groups, the regions that regional average GDP higher than global, and regions with regional GDP lower than global, to see how is the relationship between the Logged GDP per capita and the Ladder Score of countries in these regions.

```{r GDP-ord}
gdp_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Logged GDP per capita`),2))%>%
  arrange(-Average)

  gdp_mean %>% 
    kable(caption = "Average Logged GDP per capita of Regions from High to Low") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r GDP-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Logged GDP per capita`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Logged GDP per capita`)),
             linetype = "dashed")

mean(WHR20$`Ladder score`)

mean(WHR20$`Logged GDP per capita`)

quantile(WHR20$`Logged GDP per capita`)
```

In Figure \@ref(fig:GDP-high), We found the countries in Western Europe and North America and ANZ, and most of the countries in East Asia and Central and Eastern Europe, have a higher score on either Ladder Score and GDP. In the Middle East and North Africa and South Asia, they are polarized, several countries are with high GDP and high Ladder Scores, several got low scores either on Ladder Score or GDP.

While what we found interesting and different from other Region is in Latin America and Caribbean, some countries even their GDP is lower than the average level, their Ladder Score is high. On the contrary, some countries in the Middle East and North Africa, they got higher GDP score, however, their Ladder Scores are low.

```{r GDP-high, fig.cap = "Ladder Score vs GDP for the Regions with Regional GDP Means Higher than Total Means"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

Below Figure \@ref(fig:GDP-low) shows the regions whose regional GDP scores are lower than the average GDP of all the countries, it indicates most countries in these regions, their Ladder Scores are also lower.

```{r GDP-low, fig.cap = "Ladder Score vs GDP for the Regions with Regional GDP Means Lower than Total Means"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Commonwealth of Independent States",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Logged GDP per capita`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept =9.295706),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

\subsection*{2.2 Social Support}

The average Social Support of regions from high to low is shown in Table \@ref(tab:SS-ord).

The same method as GDP, we calculated the average Social Support of all counties, it is `r mean(WHR20$`Social support`)`. 

```{r SS-ord}
SS_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Social support`),2))%>%
  arrange(-Average)

  SS_mean %>% 
    kable(caption = "Average Social Support of Regions from High to Low") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r SS-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Social support`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Social support`)),
             linetype = "dashed")

mean(WHR20$`Social support`)

quantile(WHR20$`Social support`)
```

Either the high Social Support group (shows in Figure \@ref(fig:SS-high)) or low Social Support group (Figure \@ref(fig:SS-low)), we nearly found no country has low Social Support score but got high Ladder Score. The relationship between Social Support and Ladder Score is close to a positive correlation. The better Social Support, the more possible it to get a better Ladder Score; on the opposite, as shown in Figure \@ref(fig:SS-low), the worse Social Support, the lower the Ladder Score. 

But not all the high score Social Support countries also got high Ladder Scores. In Central and Eastern Europe, Commonwealth of Independent States, Middle East and North Africa, South Asia, and Sub-Saharan Africa, some countries with high Social Support scores got low Ladder Scores.

```{r SS-high, fig.cap = "Ladder Score vs Social Support for the Regions with Regional Social Support Means Higher than Total Means"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

```{r SS-low, fig.cap = "Ladder Score vs Social Suppor Lower than Total Means"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("Middle East and North Africa",
             "South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Social support`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 0.8087211),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

\subsection*{2.3 Healthy Life Expectancy}

Table \@ref(tab:HLE-ord) shows the ranking of Social Healthy Life Expectancy score of regions.

```{r HLE-ord}
HLE_mean <- WHR20 %>% 
  group_by(`Regional indicator`) %>% 
  summarise(Average 
            = round(mean(`Healthy life expectancy`),2))%>%
  arrange(-Average)

  HLE_mean %>% 
    kable(caption = "Healthy life expectancy") %>%
      kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r HLE-dens, eval = FALSE}
ggplot(WHR20, aes(x = `Healthy life expectancy`))+
  geom_density()+
  geom_vline(aes(xintercept =
                   mean(`Healthy life expectancy`)),
             linetype = "dashed")

mean(WHR20$`Healthy life expectancy`)

quantile(WHR20$`Healthy life expectancy`)
```

In the high Healthy Life Expectancy score countries group, it shows a positive correlation in Southeast Asia, Middle East and North Africa and North America and ANZ. But we found in the Commonwealth of Independent States, Central and Eastern Europe, Western Europe, some countries are almost at the same level of Healthy life Expectancy, their Ladder Scores arrange from a big difference. See that in Figure \@ref(fig:HLE-high).

```{r HLE-high, fig.cap = "Ladder Score vs Healthy Life Expectancy Higher than Total Means"}
 WHR20 %>%
  filter(!`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

Figure \@ref(fig:HLE-low) shows, in the low Healthy Life Expectancy region, they also have a low Ladder Score, while they don't look have a special relationship between Healthy Life Expectancy and Ladder Score. 

```{r HLE-low, fig.cap = "Ladder Score vs Healthy Life Expectancy Lower than Total Means"}
 WHR20 %>%
  filter(`Regional indicator` %in% 
           c("South Asia", 
             "Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Healthy life expectancy`)) +
  geom_point() +
  geom_vline(aes(xintercept = 5.47324),
             linetype = "dashed") +
  geom_hline(aes(yintercept = 64.44553),
             linetype = "dashed") +
  facet_wrap(~`Regional indicator`, ncol = 3)
```

```{r lm, eval = FALSE}
lm <- lm(formula = `Ladder score` ~ `Logged GDP per capita` + `Social Support` + `Healthy life expectancy` + `Freedom to make life choices` + `Generosity` + `Perceptions of corruption`, data = WHR20)

summary(lm)
```


\subsection*{2.4 Freedom to make life choices }

**Freedom to make life choices** is the national average of binary responses to the GWP question, “Are you satisfied or dissatisfied with your freedom to choose what you do with your life?” @WHReport.

```{r, include=FALSE}
free_avg <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Freedom to make life choices`)) %>% 
  arrange(desc(average))
```


```{r tabfree}
knitr::kable(free_avg, caption = "The Average Freedom to Make Life Choices Score by Region",
      col.names = c("Region", "Average Score")) %>% 
  kable_styling(c("hover", 
                  "condensed",
                  position = "center", 
                  fixed_thead = TRUE))
```

The above table \@ref:(tab:tabfree) is the average "freedom to make life choices" score among all the regions. We divided them into three groups by the average score greater than 0.80, 0.75-0.80, and lower than 0.75.

```{r freeh, fig.cap="The Group of High Freedom to Make Life Choices Score", fig.width=10}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Southeast Asia",  "North America and ANZ", "Western Europe", "Latin America and Caribbean")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Freedom to make life choices`)) +
  geom_point() +
  facet_grid(~`Regional indicator`)+
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Freedom to make life choices`)),
             linetype = "dashed") 
```

As the figure \@ref(fig:freeh) above, in the group of the "Freedom to make life choices" score is higher than 0.80 the ladder scores in Latin America and Caribbean, North America and ANZ, Western Europe are comparably high as well. Specifically, most of the points in these three rigions are on the right of the average line. However, in Southeast Asia, the points surrounding the average line represent the ladder scores are not as high as the others.

```{r freem, fig.cap="The Group of Middle Freedom to Make Life Choices Score", fig.width=10}
WHR20 %>%
  filter(`Regional indicator` %in% c("Commonwealth of Independent States", "South Asia", "Central and Eastern Europe", "East Asia")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Freedom to make life choices`)),
             linetype = "dashed") 
```

The above figure \@ref(fig:freem) is the group of regions with middle "Freedom to make life choices" score of 0.75-0.80.  The distribution of the points is generally surrounding the average line. However, in South Asia, most of the points are lower than the average.

```{r freel, fig.cap="The Group of Low Freedom to Make Life Choices Score"}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Sub-Saharan Africa", "Middle East and North Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Freedom to make life choices`)),
             linetype = "dashed") 
```

From the above figure \@ref(fig:freel), in the low "Freedom to make life choices" score, which is less than 0.75, a tremendous amount of the points of Sub-Saharan Africa are on the left of the average line. However, the points are scattered evenly from high to low in the Middle East and North Africa. 

*In general, the ladder score is related to the "Freedom to make life choices" score in most of the regions, except Southeast Asia, and Middle East and North Africa.*


\subsection*{2.5 Generosity }

Generosity is the residual of regressing the national average of GWP responses to the question, “Have you donated money to a charity in the past month?” on GDP per capita @WHReport.

The table below \@ref:(tab:tabgene) is the average generosity score among all the regions. We divided them into two groups by the average score over and below 0.

```{r tabgene}
gene_avg  <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Generosity`)) %>% 
  arrange(desc(average))

  knitr::kable(gene_avg, caption = "The Average Generosity Score by Region",
                col.names = c("Region", "Average Score")) %>% 
  kable_styling(c("hover", 
                  "condensed",
                  position = "center", 
                  fixed_thead = TRUE))
```


```{r geneh, fig.cap="The Group of the Generosity Score Higher Than 0", fig.width=10}
 WHR20 %>%
  filter(`Regional indicator` %in% c("North America and ANZ","Southeast Asia","Western Europe","South Asia","Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
             y = `Generosity`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Generosity`)),
             linetype = "dashed") 
```

From the above figure \@ref(fig:geneh), in the group of the generosity score higher than 0, the ladder score in North America and ANZ, and Western Europe is higher than the average. On the contrary, in South Asia and Sub-Saharan Africa, the points overwhelmingly position left than the average line. The points for Southeast Asia is around the average line.


```{r genel, fig.cap="The Group of the Generosity Score Less Than 0", fig.width=13}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Commonwealth of Independent States","East Asia","Latin America and Caribbean","Middle East and North Africa","Central and Eastern Europe")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Generosity`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Generosity`)),
             linetype = "dashed") 
```

The above figure \@ref(fig:genel) indicates that in the group of the generosity score less than 0, except of Latin America and Caribbean, the ladder score distributed scattered around the average ladder score line.

*In general, the generosity score does not show a relationship with the ladder score.*

\subsection*{2.6 Perceptions of corruption }

Perceptions of corruption are the average of binary answers to two GWP questions: “Is corruption widespread throughout the government or not?” and “Is corruption widespread within businesses or not?” Where data for government corruption are missing, the perception of business corruption is used as the overall corruption-perception measure @WHReport. 

The table below \@ref:(tab:tabcor) is the average "perceptions of corruption" score among all the regions. We divided them into three groups by the average score greater than 0.75, 0.70-0.75, lower than 0.70. 

```{r tabcor}
perc_avg  <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Perceptions of corruption`)) %>% 
  arrange(desc(average))

knitr::kable(perc_avg, caption = "The Perceptions of Corruption Score by Region",
                col.names = c("Region", "Average Score")) %>% 
  kable_styling(c("hover", 
                  "condensed",
                  position = "center", 
                  fixed_thead = TRUE))
```


```{r corl, fig.cap="The Group of Low Perceptions of Corruption Score"}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Western Europe","North America and ANZ")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Perceptions of corruption`)),
             linetype = "dashed") 
```

From the figure \@ref(fig:corl), in the group of low "perceptions of corruption" scores with less than 0.70, surprisingly, all the points are at the right of the average ladder score line. This means that if the region has low "perceptions of corruption" scores, the ladder score would be high.

```{r corm, fig.cap="The Group of Middle Perceptions of Corruption Score", fig.width=15}
 WHR20 %>%
  filter(`Regional indicator` %in% c("South Asia","Sub-Saharan Africa","Middle East and North Africa", "Commonwealth of Independent States","Southeast Asia","East Asia")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Perceptions of corruption`)),
             linetype = "dashed") 
```

From the figure \@ref(fig:corm), in the group of middle "perceptions of corruption" scores with between 0.70 and 0.80, except South Asia and Sub-Saharan Africa shows lower ladder score, the other regions all indicate a middle ladder score.

```{r corh, fig.cap="The Group of High Perceptions of Corruption Score"}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Central and Eastern Europe","Latin America and Caribbean")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_grid(~`Regional indicator`) +
  geom_vline(aes(xintercept = mean(WHR20$`Ladder score`)),
             linetype = "dashed") +
  geom_hline(aes(yintercept = mean(WHR20$`Perceptions of corruption`)),
             linetype = "dashed") 
```

The above figure \@ref(fig:corh) is the group of regions with high "perceptions of corruption" scores greater than 0.80. In Central and Eastern Europe, and Latin America and Caribbean, most of the points are on the right of the average line. This means, the region with high "perceptions of corruption" scores could lead to a comparably high ladder score.

*In conclusion, as for the "perceptions of corruption" score, the lowest and the highest four regions all have a high ladder score. Most of the regions in the middle score groups show the middle ladder score.*

\clearpage
\section*{3 }

\subsection*{3.1 }

* Compare Top5, Middle5 and Worst5 Countries

```{r include=FALSE}
top5 <- happiness %>% head(5) %>% mutate(Level = "TOP5")
middle5 <- happiness[76:80, ] %>% mutate(Level = "MIDDLE5")
worst5 <- happiness %>% tail(5) %>% mutate(Level = "WORST5")

comparison <- bind_rows(top5, middle5, worst5)

comparison$Level <- as.factor(comparison$Level)
comparison <- transform(comparison, Level = factor(Level, levels = c("TOP5", "MIDDLE5", "WORST5" )))
```

```{r include=FALSE}

data.table(comparison,
          options = list(
            lengthMenu = c(5, 10, 15)
          ),
          caption = 
            htmltools::tags$caption(
              style = 'caption-side: bottom; text-align: center;', 
              htmltools::em('Data table that only includes top5, middle5 and worst5 countries'))
          )

```

```{r include=FALSE}
comparison.score <- comparison %>% rename("Economy GDP" = "logged_gdp_per_capita" , "Social Support" = "social_support" , "Health" = "healthy_life_expectancy", "Freedom" = "freedom_to_make_life_choices", "Corruption" ="perceptions_of_corruption") %>% 
  gather(key = "columns", value = "score", happiness_score:Corruption)

```


```{r compare, fig.cap="Compare top, median and bottom five countries",  fig.width=10}
comparison.score %>% 
  ggplot(aes(x = Level, y = score, colour = Level, fill = Level)) + 
  geom_boxplot(position=position_dodge(width=1)) + facet_wrap(~columns, scales = "free") 


```

* Analyzing data of Global Happiness Levels in the world,we were able to discover the impact of each different factor in determining “happiness.”
* Factors to determine happiness score of a country are GDP, Freedom to make choices, how less is the corruption, generosity, heath and social support.
* To understand the relations between factors and happiness score we have take data for the top, median and bottom five countries according to ranked scores in the above figure \@ref(fig:compare).
* We observe that the countries with highest happiness score have a better GDP, less corruption, more freedom to make choices, good health ratio, more generosity and receive social support. 


\subsection*{3.2 }

**Happiness Score for Countries**

The WHR calculates how much of the Happiness Index can be explained by the key factors. Add them all up and you should get close to the actual number. <br>

From the below map \@ref(fig:map) you can easily spot the happiest country, Finland. <br>
Finland is ranked 1st according to the happiness score it has. It is said one of the reason why Finnish people are so happy is that they do not have to deal with corruption and black money. <br>
Countries such as Afghanistan and South Sudan have least happiness score.

```{r map, fig.cap= "World Happiness Map", fig.width=8}

fig <- plot_ly(happiness, type='choropleth', locations= happiness$iso3 , z= happiness$happiness_score, text= ~paste(
                      "<br><b>Country:</b> ", country_name,
                      "<br><b>Happiness rank:</b>", happiness_rank), colorscale="Viridis")

fig <- fig %>% colorbar(title = "Happiness Score" )

fig <- fig %>% layout(
    title = 'World Happiness Map, Year 2020')
fig

```




\clearpage
\section*{Conclusion}

\clearpage
\section*{References}

World Happiness Report. 2020. The World Happiness Report 2020. [online] Available at: https://worldhappiness.report/ed/2020/

Hadley Wickham and Jennifer Bryan (2019). readxl: Read Excel Files. R package version 1.3.1. https://CRAN.R-project.org/package=readxl

Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686

Sam Firke (2021). janitor: Simple Tools for Examining and Cleaning Dirty Data. R package version 2.1.0. https://CRAN.R-project.org/package=janitor

C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC Florida, 2020.

Hao Zhu (2021). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R package version 1.3.4. https://CRAN.R-project.org/package=kableExtra

Yihui Xie (2020). bookdown: Authoring Books and Technical Documents with R Markdown. R package version 0.21.

Yihui Xie (2016). bookdown: Authoring Books and Technical Documents with R Markdown. Chapman and Hall/CRC. ISBN 978-1138700109

H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

Hadley Wickham (2019). stringr: Simple, Consistent Wrappers for Common String Operations. R package version 1.4.0. https://CRAN.R-project.org/package=stringr