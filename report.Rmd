---
title: "World Happiness Report 2020"
author:
- familyname: Luo
  othernames: Yu
  address: Monash University
  email: yluo0065@student.monash.com
  correspondingauthor: true
  qualifications:  Master
- familyname: Thakker
  othernames: Khushee
  address: Monash University
  email: ktha0021@student.monash.edu
  qualifications: Master
- familyname: Chen
  othernames: Yunqi
  address: Monash University
  email: yche0454@student.monash.edu
  correspondingauthor: true
  qualifications:  Master
organization: the World Bank data base
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::html_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: inline
---

```{r setup, echo = FALSE, message = FALSE, warning = FALSE, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message=FALSE, 
                      warning=FALSE,
                      fig.width = 6, 
                      fig.height = 4,
                      fig.align="center")
knitr::opts_chunk$set(fig.pos = "!h", out.extra = "")

# Libraries

library(tidyverse)
library(readxl)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(stringr)
library(lubridate)
```


```{r read-data}
# Read the data
WHR20 <- read_excel("Data/WHR20_DataForFigure2.1.xls")
```

\section*{Introduction}

\section*{1 }

\subsection*{1.2 }


\clearpage
\section*{2 }

\subsection*{2.1 }


\subsection*{2.4 Freedom to make life choices }

```{r}
library(plotly)
```

the score of "Freedom to make life choices" from high to low:
```{r}
free_avg <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Freedom to make life choices`)) %>% 
  arrange(desc(average))
```


```{r}
knitr::kable(free_avg, caption = "The Average Freedom to Make Life Choices Score by Region",
      col.names = c("Region", "Average Score")) %>% 
  kable_styling(c("hover", 
                  "condensed",
                  position = "center", 
                  fixed_thead = TRUE))
```

The above table is the average "freedom to make life choices" score among all the regions. We divided them into three groups by the average score greater than 8.0, 0.75-0.8, and lower than 0.75.

```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Southeast Asia",  "North America and ANZ", "Western Europe", "Latin America and Caribbean")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)+
  labs(caption = "The Group of High Freedom to Make Life Choices Score")

```

As the figure above, in the group of the "Freedom to make life choices" score is greater than 8.0, the ladder scores in North America and ANZ, and Western Europe are comparably high as well. However, in Latin America and Caribbean, and Southeast Asia, the ladder scores are not as high as the previous two regions.

```{r}
WHR20 %>%
  filter(`Regional indicator` %in% c("Commonwealth of Independent States", "South Asia", "Central and Eastern Europe", "East Asia")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)+
  labs(caption = "The Group of Middle Freedom to Make Life Choices Score")
```

From the above figure, in the group of the "Freedom to make life choices" score between 0.75 and 0.8, the ladder score in Central and Eastern Europe is very high. The other three regions have the same middle ladder score. 

"Freedom to make life choices" score lower than 0.75:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Sub-Saharan Africa", "Middle East and North Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Freedom to make life choices`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```

In the low "Freedom to make life choices" score, which is less than 0.75, the ladder score of Sub-Saharan Africa is low. However, in the Middle East and North Africa, the ladder score is more dispersed. 



\subsection*{2.5 Generosity }

the score of "Generosity" from high to low:

```{r}
gene_avg  <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Generosity`)) %>% 
  arrange(desc(average))

  kable(gene_avg)
```


Generosity score greater than 0:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("North America and ANZ","South Asia","Western Europe","South Asia","Sub-Saharan Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Generosity`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```

Generosity score lower than 0:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Commonwealth of Independent States","East Asia","Latin America and Caribbean","Middle East and North Africa","Central and Eastern Europe")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Generosity`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```


\subsection*{2.6 Perceptions of corruption }

the score of "Perceptions of corruption" from high to low:

```{r}
perc_avg  <- WHR20 %>%
  group_by(`Regional indicator`) %>% 
  summarise(average = mean(`Perceptions of corruption`)) %>% 
  arrange(desc(average))

  kable(perc_avg)
```

"Perceptions of corruption" score greater than 0.75:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Central and Eastern Europe","Latin America and Caribbean","South Asia","Sub-Saharan Africa","Middle East and North Africa")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```

"Perceptions of corruption" score between 0.70-0.75:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Commonwealth of Independent States","Southeast Asia","East Asia")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```

"Perceptions of corruption" score lower than 0.70:
```{r}
 WHR20 %>%
  filter(`Regional indicator` %in% c("Western Europe","North America and ANZ")) %>% 
  ggplot(aes(x = `Ladder score`, 
               y = `Perceptions of corruption`)) +
  geom_point() +
  facet_wrap(~`Regional indicator`, nrow = 1)
```


\clearpage
\section*{3 }

\subsection*{3.1 }

\clearpage
\section*{References}


